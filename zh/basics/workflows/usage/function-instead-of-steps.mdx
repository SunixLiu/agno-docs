---
title: 使用函数替代步骤
description: 此示例演示了如何在工作流中仅使用单个函数而非多个步骤。
---

此示例演示了**工作流**如何使用单个自定义执行函数，而非离散的步骤。这种模式在保留工作流特性（如存储、流式传输和会话管理）的同时，赋予了您对编排逻辑的完全控制权。

**使用场景**：当您需要对执行流程拥有最大的灵活性和控制权时，类似于 Workflows 1.0 的方法，但采用了更结构化的方式。


```python function_instead_of_steps.py
from agno.agent import Agent
from agno.db.sqlite import SqliteDb
from agno.models.openai import OpenAIChat
from agno.team import Team
from agno.tools.duckduckgo import DuckDuckGoTools
from agno.tools.hackernews import HackerNewsTools
from agno.workflow.types import WorkflowExecutionInput
from agno.workflow.workflow import Workflow

# Define agents
hackernews_agent = Agent(
    name="Hackernews Agent",
    model=OpenAIChat(id="gpt-5-mini"),
    tools=[HackerNewsTools()],
    role="Extract key insights and content from Hackernews posts",
)
web_agent = Agent(
    name="Web Agent",
    model=OpenAIChat(id="gpt-5-mini"),
    tools=[DuckDuckGoTools()],
    role="Search the web for the latest news and trends",
)

# Define research team for complex analysis
research_team = Team(
    name="Research Team",
    members=[hackernews_agent, web_agent],
    instructions="Research tech topics from Hackernews and the web",
)

content_planner = Agent(
    name="Content Planner",
    model=OpenAIChat(id="gpt-5-mini"),
    instructions=[
        "Plan a content schedule over 4 weeks for the provided topic and research content",
        "Ensure that I have posts for 3 posts per week",
    ],
)


def custom_execution_function(
    workflow: Workflow, execution_input: WorkflowExecutionInput
):
    print(f"Executing workflow: {workflow.name}")

    # Run the research team
    run_response = research_team.run(execution_input.input)
    research_content = run_response.content

    # Create intelligent planning prompt
    planning_prompt = f"""
        STRATEGIC CONTENT PLANNING REQUEST:

        Core Topic: {execution_input.input}

        Research Results: {research_content[:500]}

        Planning Requirements:
        1. Create a comprehensive content strategy based on the research
        2. Leverage the research findings effectively
        3. Identify content formats and channels
        4. Provide timeline and priority recommendations
        5. Include engagement and distribution strategies

        Please create a detailed, actionable content plan.
    """
    content_plan = content_planner.run(planning_prompt)

    # Return the content plan
    return content_plan.content


# Create and use workflow
if __name__ == "__main__":
    content_creation_workflow = Workflow(
        name="Content Creation Workflow",
        description="Automated content creation from blog posts to social media",
        db=SqliteDb(
            session_table="workflow_session",
            db_file="tmp/workflow.db",
        ),
        steps=custom_execution_function,
    )
    content_creation_workflow.print_response(
        input="AI trends in 2024",
    )
```

这是该模式的一个同步非流式示例。要查看异步和流式版本，请参阅以下菜谱：
- [使用函数替代步骤 (同步流式)](https://github.com/agno-agi/agno/blob/main/cookbook/05_workflows/_01_basic_workflows/_03_function_instead_of_steps/sync/function_instead_of_steps_stream.py)
- [使用函数替代步骤 (异步非流式)](https://github.com/agno-agi/agno/blob/main/cookbook/05_workflows/_01_basic_workflows/_03_function_instead_of_steps/async/function_instead_of_steps.py)
- [使用函数替代步骤 (异步流式)](https://github.com/agno-agi/agno/blob/main/cookbook/05_workflows/_01_basic_workflows/_03_function_instead_of_steps/async/function_instead_of_steps_stream.py)